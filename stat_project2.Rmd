---
title: Statistical Inference course project - The Effect of Vitamin C on Tooth Growth
  in Guinea Pigs
author: "Evgeniy Zabrodskiy"
date: "November, 2015"
output:
  pdf_document: default
  html_document:
    keep_md: yes
---
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.height = 4, fig.width = 6)
```

```{r}
library(ggplot2)
```

## Overview
The goal of this analysis is to explore the ToothGrowth data, make assumptions and apply statistical inference methods to confirm or reject those assumptions.  
The dataset ToothGrowth contains the length of odontoblasts (teeth) in each of 60 guinea pigs at each of three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods (orange juice or ascorbic acid).

## Exploratory analysis
### Basic summary of the data
ToothGrowth dataframe structure:  
```{r}
data("ToothGrowth")
str(ToothGrowth)
```
We can see that there are three variables:  
- len contains the length of the odontoblasts in microns;  
- supp is a factor variable showing the type of the supplement containing Vitamin C ("OJ" == Orange Juice, "VC" == Ascrobic Acid);  
- dose stores the dose of Vitamin C in miligrams. It will be converted to factor for convenience.  

Dataframe summary:  
```{r}
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
summary(ToothGrowth)
```

Two first lines of the data:  
```{r}
head(ToothGrowth, 2)
```

### Exploratory plots
This boxplot shows the distribution of length per supp.  
```{r}
qplot(data = ToothGrowth, 
      geom = "boxplot", 
      x = supp, 
      y = len, 
      color = supp)
```

This plot raises a question whether the length of odontoblasts of pigs receiving Vitamin C with orange juice is not equal to the mean length in the group of pigs which recieved Vitamin C as ascrobic acid, not taking into account different doses. But it would be better to divide the boxes by dose to make better assumptions.  

The boxplot below shows the distribution of length for each supp per dose:  
```{r}
qplot(data = ToothGrowth, 
      geom = "boxplot", 
      x = dose, 
      y = len, 
      color = supp)
```

This boxplot shows some more details based on which we make the following assumptions:  

**Assumption 1**: Mean length of odontoblasts is different for group of pigs which received Vitamin C with orange juice and group of pigs which recieved Vitamin C as ascrobic acid, dose 0.5 mg.  

**Assumption 2**: Mean length of odontoblasts is different for group of pigs which received Vitamin C with orange juice and group of pigs which recieved Vitamin C as ascrobic acid, dose 1 mg.  

**Assumption 3**: There is no significant difference in mean lengths for both supplements with dose 2 mg.

The boxplot below shows the distribution of length for each dose per supp:  
```{r}
qplot(data = ToothGrowth, 
      geom = "boxplot", 
      x = supp, 
      y = len, 
      color = dose)
```

**Assumption 4**: Mean length of odontoblasts is different for subgroups with doses 0.5 mg and 1 mg in group which recieved Vitamin C with orange juice.  

There are more assumptions that can be made but they are all similar and are tested the same way. 

## Testing assumptions and conclusions
Talking about lengths of odontoblasts we may assume that the lengths population is normally distributed even though we cannot clearly see that from the sample data. Based on this assumption and taking into account that the sample sizes of the groups we are going to compare is quite small (10 elements each), we should use Student's T-test to confirm or reject our assumptions. Also it is assumed that the variances of the populations of tested samples are different since all the pigs belong to the same spicies and the study is randomized.

**Assumption 1**: Mean length of odontoblasts is different for group of pigs which received Vitamin C with orange juice and group of pigs which recieved Vitamin C as ascrobic acid, dose 0.5 mg.  

$H_{0}:\mu_{oj,0.5} = \mu_{vc,0.5}$  
$H_{1}:\mu_{oj,0.5} \ne \mu_{vc,0.5}$  

```{r}
len.VC.05 <- ToothGrowth$len[ToothGrowth$supp == "VC" & ToothGrowth$dose == 0.5]
len.OJ.05 <- ToothGrowth$len[ToothGrowth$supp == "OJ" & ToothGrowth$dose == 0.5]
t1 <- t.test(len.VC.05, 
             len.OJ.05, 
             alternative = "two.sided", 
             paired = FALSE, 
             var.equal = TRUE)
t1
```

From the T-test output we can see that p-value = $`r t1$p.value`$ which represents the probability of $H_{0}$ being true and since it is less than $\alpha = 0.05$ for a two-sided test we may reject $H_{0}$. Also the confidence interval which does not contain zero can be used to make the same conclusion. It means that with 95% probability ($1-\alpha$) the true difference of the means of the populations will be within the borders of the interval. 

**Conclusion 1**: Assumption 1 is confirmed: mean length of odontoblasts is different for the groups of pigs which recieved 0.5 mg dose of Vitamin C in forms of orange juice and ascorbic acid.  

**Assumption 2**: Mean length of odontoblasts is different for group of pigs which received Vitamin C with orange juice and group of pigs which recieved Vitamin C as ascrobic acid, dose 1 mg.  

$H_{0}:\mu_{oj,1} = \mu_{vc,1}$  
$H_{1}:\mu_{oj,1} \ne \mu_{vc,1}$  

```{r}
len.VC.1 <- ToothGrowth$len[ToothGrowth$supp == "VC" & ToothGrowth$dose == 1]
len.OJ.1 <- ToothGrowth$len[ToothGrowth$supp == "OJ" & ToothGrowth$dose == 1]
t2 <- t.test(len.VC.1, 
             len.OJ.1, 
             alternative = "two.sided", 
             paired = FALSE, 
             var.equal = TRUE)
t2
```

From the T-test output we can see that p-value = $`r t2$p.value`$ which represents the probability of $H_{0}$ being true and since it is less than $\alpha = 0.05$ for a two-sided test we may reject $H_{0}$.  

**Conclusion 2**: Assumption 2 is confirmed: mean length of odontoblasts is different for the groups of pigs which recieved 1 mg dose of Vitamin C in forms of orange juice and ascorbic acid.

**Assumption 3**: There is no significant difference in mean lengths for both supplements with dose 2 mg.  

$H_{0}:\mu_{oj,2} = \mu_{vc,2}$  
$H_{1}:\mu_{oj,2} \ne \mu_{vc,2}$  

```{r}
len.VC.2 <- ToothGrowth$len[ToothGrowth$supp == "VC" & ToothGrowth$dose == 2]
len.OJ.2 <- ToothGrowth$len[ToothGrowth$supp == "OJ" & ToothGrowth$dose == 2]
t3 <- t.test(len.VC.2, 
             len.OJ.2, 
             alternative = "two.sided", 
             paired = FALSE, 
             var.equal = TRUE)
t3
```

From the T-test output we can see that p-value = $`r t3$p.value`$ which represents the probability of $H_{0}$ being true. This pobability is so high, so we cannot reject the $H_{0}$ for sure.  

**Conclusion 3**: Assumption 3 is confirmed: mean length of odontoblasts is the same for the groups of pigs which recieved 2 mg dose of Vitamin C in forms of orange juice and ascorbic acid.

**Assumption 4**: Mean length of odontoblasts is different for subgroups with doses 0.5 mg and 1 mg in group which recieved Vitamin C with orange juice.  

$H_{0}:\mu_{oj,0.5} = \mu_{oj,1}$  
$H_{1}:\mu_{oj,0.5} \ne \mu_{oj,1}$  

```{r}
len.OJ.05 <- ToothGrowth$len[ToothGrowth$supp == "OJ" & ToothGrowth$dose == 0.5]
len.OJ.1 <- ToothGrowth$len[ToothGrowth$supp == "OJ" & ToothGrowth$dose == 1]
t4 <- t.test(len.OJ.05, 
             len.OJ.1, 
             alternative = "two.sided", 
             paired = FALSE, 
             var.equal = TRUE)
t4
```

From the T-test output we can see that p-value = $`r t4$p.value`$ which represents the probability of $H_{0}$ being true and since it is less than $\alpha = 0.05$ for a two-sided test we may reject $H_{0}$.  

**Conclusion 4**: Assumption 4 is confirmed: mean length of odontoblasts difference is significant for subgroups of pigs which recieved 0.5 mg and 1 mg dose of Vitamin C with orange juice.
